<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Transcript: {{ student.full_name }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        /* ==========================================================================
           Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
           ========================================================================== */
        @page {
            size: A4 portrait;
            margin: 0;
        }

        body {
            margin: 0;
            padding: 0;
            background: #555; /* Ø®Ù„ÙÙŠØ© Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© ÙÙ‚Ø· */
            font-family: 'Times New Roman', serif;
            color: #000;
            -webkit-print-color-adjust: exact;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„ÙˆØ±Ù‚Ø© A4 */
        .sheet {
            width: 210mm;
            min-height: 297mm;
            margin: 20px auto;
            background: white;
            /* Ù…Ø³Ø§ÙØ© Ø¹Ù„ÙˆÙŠØ© 5 Ø³Ù… Ù„Ù„ØªØ±ÙˆÙŠØ³Ø© Ø§Ù„Ù…Ø·Ø¨ÙˆØ¹Ø© (Ø§Ù„Ø´Ø¹Ø§Ø±) */
            padding: 50mm 20mm 20mm 20mm; 
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            page-break-after: always;
        }

        @media print {
            body { background: white; }
            .sheet { margin: 0; width: 100%; height: 297mm; box-shadow: none; border: none; }
            .no-print { display: none !important; }
        }

        /* ==========================================================================
           ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ±ÙˆÙŠØ³Ø©
           ========================================================================== */
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            width: 100%;
            margin-bottom: 20px;
            direction: inherit;
        }

        .header-text {
            font-size: 11pt;
            font-weight: bold;
            line-height: 1.5;
            padding-top: 5px; 
        }

        .photo-frame {
            width: 35mm;
            height: 45mm;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ccc; /* Ø¥Ø·Ø§Ø± Ø®ÙÙŠÙ Ù„Ù„ØµÙˆØ±Ø© */
        }
        .photo-frame img { width: 100%; height: 100%; object-fit: cover; }

        /* ==========================================================================
           ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù†ØµÙˆØµ ÙˆØ§Ù„Ø¬Ø¯Ø§ÙˆÙ„
           ========================================================================== */
        .ltr { direction: ltr; }
        .rtl { direction: rtl; }

        .ltr .header-text { text-align: left; }
        .rtl .header-text { text-align: right; }

        .center-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 15px;
            clear: both;
        }
        .main-title { font-size: 16pt; margin-bottom: 5px; }
        .sub-title { font-size: 14pt; }

        .body-text {
            font-size: 12pt;
            line-height: 1.6;
            text-align: justify;
            margin-bottom: 20px;
        }
        .body-text b { font-weight: bold; }

        .grades-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10pt;
            margin-bottom: 20px;
            direction: ltr;
        }
        .grades-table th, .grades-table td {
            border: 1px solid #000;
            padding: 4px;
            text-align: center;
            height: 22px;
        }
        .grades-table th { background-color: #e0e0e0 !important; font-weight: bold; }
        .grades-table.rtl-table { direction: rtl; }

        .footer-points {
            font-size: 11pt;
            line-height: 1.6;
            margin-top: 10px;
        }

        .footer-points.ltr { direction: ltr; text-align: left; }
        .footer-points.rtl { direction: rtl; text-align: right; }

        /* Ø§Ù„ØªÙˆØ§Ù‚ÙŠØ¹ */
        .signatures-container { margin-top: 50px; width: 100%; }
        .signatures-top, .signatures-middle {
            display: flex; justify-content: space-between; margin-bottom: 70px; padding: 0 30px;
        }
        .signatures-bottom { text-align: center; margin-top: 40px; }
        .sig-box { text-align: center; font-weight: bold; font-size: 11pt; }
        .sig-title { margin-bottom: 40px; }
        .sig-name { border-top: 1px solid #000; padding-top: 5px; min-width: 150px; display: inline-block; }

    </style>
</head>
<body>

    <div class="no-print" style="text-align: center; padding: 15px; background: #222; color: #fff;">
        <button onclick="window.print()" style="padding: 10px 25px; font-size: 16px; cursor: pointer; background: #00ff9d; border: none; font-weight: bold; border-radius: 5px;">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©</button>
        <br><br>ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø·Ø§Ø¨Ø¹Ø©: A4
    </div>

    <div class="sheet ltr">
        <div class="header-container">
            <div class="header-text">
                Faculty of Computer Sciences and Mathematics<br>
                No: {{ transcript_number or '.....' }}<br>
                Date: {{ issue_date.strftime('%d/%m/%Y') if issue_date else '../../....' }}
            </div>
            <div class="photo-frame">
                {% if student.image_filename %}
                    <img src="{{ url_for('static', filename='uploads/' + student.image_filename) }}">
                {% else %}
                    <span>No Photo</span>
                {% endif %}
            </div>
        </div>

        <div class="center-title">
            <div class="main-title">Transcript</div>
            <div class="sub-title">To: Whom It May Concern</div>
        </div>

        <div class="body-text ltr">
            This is to certify that Mr./Mrs. ( <b>{{ student.full_name_en or student.full_name }}</b> ) whose photo is affixed above has accomplished the requirements of study for graduation in ( <b>{{ admission.year }}</b> ) on ( <b>{{ grad_date }}</b> ). Therefore, he/she is awarded ( <b>{{ student.level_en or student.level }}</b> ) degree in this field of study with an average of ( <b>{{ admission.avg }}</b> ). Below are the marks obtained in the academic subjects stated.
        </div>
    </div>


    <div class="sheet ltr">
        <div class="header-container">
            <div class="header-text">
                Faculty of Computer Sciences and Mathematics<br>
                No: {{ transcript_number or '.....' }}<br>
                Date: {{ issue_date.strftime('%d/%m/%Y') if issue_date else '../../....' }}
            </div>
        </div>

        <div class="center-title">
            <div class="main-title">Transcript</div>
            <div class="sub-title">To: Whom It May Concern</div>
        </div>

        <div class="body-text ltr">
            This is to certify that Mr./Mrs. ( <b>{{ student.full_name_en or student.full_name }}</b> ) whose photo is affixed above has accomplished the requirements of study for graduation in ( <b>{{ admission.year }}</b> ) on ( <b>{{ grad_date }}</b> ). Therefore, he/she is awarded ( <b>{{ student.level_en or student.level }}</b> ) degree in this field of study with an average of ( <b>{{ admission.avg }}</b> ). Below are the marks obtained in the academic subjects stated.
        </div>

        <table class="grades-table">
            <thead>
                <tr>
                    <th colspan="3">First semester</th>
                    <th colspan="3">Second semester</th>
                </tr>
                <tr>
                    <th width="30%">Subject</th><th width="10%">No. credits</th><th width="10%">Mark</th>
                    <th width="30%">Subject</th><th width="10%">No. credits</th><th width="10%">Mark</th>
                </tr>
            </thead>
            <tbody>
                {% set sem1 = [] %}{% set sem2 = [] %}
                {% for c in courses %}
                    {% if 'Ø£ÙˆÙ„' in c.semester %}{% set _ = sem1.append(c) %}{% elif 'Ø«Ø§Ù†ÙŠ' in c.semester %}{% set _ = sem2.append(c) %}{% endif %}
                {% endfor %}
                {% set max_rows = sem1|length if sem1|length > sem2|length else sem2|length %}
                
                {% for i in range(max_rows) %}
                <tr>
                    <td>{{ sem1[i].course_name if i < sem1|length else '' }}</td>
                    <td>{{ sem1[i].credits if i < sem1|length else '' }}</td>
                    <td>{{ sem1[i].grade if i < sem1|length else '' }}</td>
                    
                    <td>{{ sem2[i].course_name if i < sem2|length else '' }}</td>
                    <td>{{ sem2[i].credits if i < sem2|length else '' }}</td>
                    <td>{{ sem2[i].grade if i < sem2|length else '' }}</td>
                </tr>
                {% endfor %}

                <tr style="background-color: #f0f0f0; font-weight: bold;">
                    <td colspan="2" style="text-align: right; padding-right: 5px;">Average</td>
                    <td>{{ avg_sem1 }}</td>
                    <td colspan="2" style="text-align: right; padding-right: 5px;">Average</td>
                    <td>{{ avg_sem2 }}</td>
                </tr>
            </tbody>
        </table>

        <div class="footer-points ltr">
            <div>1- NO. of credits of two semesters: <b>{{ course_credits_sum }}</b></div>
            <div>2- NO. of credits of the thesis: <b>{{ thesis_credits }}</b></div>
            <div>3- Total No. of credits: <b>{{ total_credits_all }}</b></div>
            <div>4- The thesis average: <b>{{ thesis_grade }}</b></div>
            <div>5- Final average of the thesis and two semesters: <b>{{ admission.avg if admission.avg else '.......' }}</b></div>
            <div>6- The title of the thesis:( <b>{{ research.title if research and research.title else '..................................................' }}</b> ).</div>
        </div>
    </div>


    <div class="sheet ltr">
        <div class="signatures-container ltr">
            <div class="signatures-top">
                <div class="sig-box">
                    <div class="sig-title">Transcript Organizer</div>
                    <div class="sig-name">..............................</div>
                </div>
                <div class="sig-box">
                    <div class="sig-title">Transcript Verifier</div>
                    <div class="sig-name">..............................</div>
                </div>
            </div>

            <div class="signatures-middle">
                <div class="sig-box" style="width: 40%;">
                    <div class="sig-title">Head of Students Affairs<br>and Ratification Dept</div>
                    <div class="sig-name">..............................</div>
                </div>
                <div class="sig-box" style="width: 40%;">
                    <div class="sig-title">Vice President for<br>Scientific Affairs</div>
                    <div class="sig-name">..............................</div>
                </div>
            </div>

            <div class="signatures-bottom">
                <div class="sig-box" style="margin: 0 auto; width: 50%;">
                    <div class="sig-title">Acting University President</div>
                    <div class="sig-name">..............................</div>
                </div>
            </div>

            <div style="display: flex; justify-content: space-between; margin-top: 60px; font-weight: bold; font-size: 11pt;">
                <div>Registrar</div>
                <div>Assistant of the Dean</div>
                <div>Dean</div>
            </div>
        </div>
    </div>


    <div class="sheet rtl">
        <div class="header-container">
            <div class="header-text">
                ÙƒÙ„ÙŠØ© Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ ÙˆØ§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª<br>
                Ø§Ù„Ø¹Ø¯Ø¯: {{ transcript_number or '.....' }}<br>
                Ø§Ù„ØªØ§Ø±ÙŠØ®: {{ issue_date.strftime('%Y/%m/%d') if issue_date else '.. / .. / ....' }}
            </div>
            <div class="photo-frame">
                {% if student.image_filename %}
                    <img src="{{ url_for('static', filename='uploads/' + student.image_filename) }}">
                {% else %}
                    <span>Ø¨Ø¯ÙˆÙ† ØµÙˆØ±Ø©</span>
                {% endif %}
            </div>
        </div>

        <div class="center-title">
            <div class="main-title">ÙˆØ«ÙŠÙ‚Ø© Ø¯Ø±Ø¬Ø§Øª</div>
            <div class="sub-title">Ø¥Ù„Ù‰: Ù…Ù† ÙŠÙ‡Ù…Ù‡ Ø§Ù„Ø£Ù…Ø±</div>
        </div>

        <div class="body-text rtl">
            ØªØ´Ù‡Ø¯ ÙƒÙ„ÙŠØ© Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ ÙˆØ§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø¨Ø£Ù† Ø§Ù„Ø·Ø§Ù„Ø¨/Ø§Ù„Ø·Ø§Ù„Ø¨Ø© ( <b>{{ student.full_name }}</b> ) Ø§Ù„Ù…Ø«Ø¨ØªØ© ØµÙˆØ±ØªÙ‡ Ø£Ø¹Ù„Ø§Ù‡ØŒ Ù‚Ø¯ Ø§Ø³ØªÙˆÙÙ‰ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø© Ù„Ù„ØªØ®Ø±Ø¬ ÙÙŠ Ø¹Ø§Ù… ( <b>{{ admission.year }}</b> ) Ø¨ØªØ§Ø±ÙŠØ® ( <b>{{ grad_date }}</b> ). ÙˆØ¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„ÙŠÙ‡ ØªÙ… Ù…Ù†Ø­Ù‡ Ø´Ù‡Ø§Ø¯Ø© ( <b>{{ student.level }}</b> ) ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ®ØµØµ ÙˆØ¨Ù…Ø¹Ø¯Ù„ ( <b>{{ admission.avg }}</b> ). ÙˆÙÙŠ Ø£Ø¯Ù†Ø§Ù‡ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø§Ù„ØªÙŠ Ø­ØµÙ„ Ø¹Ù„ÙŠÙ‡Ø§ ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©:
        </div>
    </div>


    <div class="sheet rtl">
        <div class="header-container">
            <div class="header-text">
                ÙƒÙ„ÙŠØ© Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ ÙˆØ§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª<br>
                Ø§Ù„Ø¹Ø¯Ø¯: {{ transcript_number or '.....' }}<br>
                Ø§Ù„ØªØ§Ø±ÙŠØ®: {{ issue_date.strftime('%Y/%m/%d') if issue_date else '.. / .. / ....' }}
            </div>
        </div>

        <div class="center-title">
            <div class="main-title">ÙˆØ«ÙŠÙ‚Ø© Ø¯Ø±Ø¬Ø§Øª</div>
            <div class="sub-title">Ø¥Ù„Ù‰: Ù…Ù† ÙŠÙ‡Ù…Ù‡ Ø§Ù„Ø£Ù…Ø±</div>
        </div>

        <div class="body-text rtl">
             ØªØ´Ù‡Ø¯ ÙƒÙ„ÙŠØ© Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³ÙˆØ¨ ÙˆØ§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø¨Ø£Ù† Ø§Ù„Ø·Ø§Ù„Ø¨/Ø§Ù„Ø·Ø§Ù„Ø¨Ø© ( <b>{{ student.full_name }}</b> ) Ø§Ù„Ù…Ø«Ø¨ØªØ© ØµÙˆØ±ØªÙ‡ Ø£Ø¹Ù„Ø§Ù‡ØŒ Ù‚Ø¯ Ø§Ø³ØªÙˆÙÙ‰ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø© Ù„Ù„ØªØ®Ø±Ø¬ ÙÙŠ Ø¹Ø§Ù… ( <b>{{ admission.year }}</b> ) Ø¨ØªØ§Ø±ÙŠØ® ( <b>{{ grad_date }}</b> ). ÙˆØ¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„ÙŠÙ‡ ØªÙ… Ù…Ù†Ø­Ù‡ Ø´Ù‡Ø§Ø¯Ø© ( <b>{{ student.level }}</b> ) ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ®ØµØµ ÙˆØ¨Ù…Ø¹Ø¯Ù„ ( <b>{{ admission.avg }}</b> ). ÙˆÙÙŠ Ø£Ø¯Ù†Ø§Ù‡ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø§Ù„ØªÙŠ Ø­ØµÙ„ Ø¹Ù„ÙŠÙ‡Ø§ ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©:
        </div>

        <table class="grades-table rtl-table">
            <thead>
                <tr>
                    <th colspan="3">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„</th>
                    <th colspan="3">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ</th>
                </tr>
                <tr>
                    <th width="30%">Ø§Ù„Ù…Ø§Ø¯Ø©</th><th width="10%">Ø§Ù„ÙˆØ­Ø¯Ø§Øª</th><th width="10%">Ø§Ù„Ø¯Ø±Ø¬Ø©</th>
                    <th width="30%">Ø§Ù„Ù…Ø§Ø¯Ø©</th><th width="10%">Ø§Ù„ÙˆØ­Ø¯Ø§Øª</th><th width="10%">Ø§Ù„Ø¯Ø±Ø¬Ø©</th>
                </tr>
            </thead>
            <tbody>
                {% for i in range(max_rows) %}
                <tr>
                    <td>{{ sem1[i].course_name if i < sem1|length else '' }}</td>
                    <td>{{ sem1[i].credits if i < sem1|length else '' }}</td>
                    <td>{{ sem1[i].grade if i < sem1|length else '' }}</td>
                    <td>{{ sem2[i].course_name if i < sem2|length else '' }}</td>
                    <td>{{ sem2[i].credits if i < sem2|length else '' }}</td>
                    <td>{{ sem2[i].grade if i < sem2|length else '' }}</td>
                </tr>
                {% endfor %}

                <tr style="background-color: #f0f0f0; font-weight: bold;">
                    <td colspan="2" style="text-align: left; padding-left: 5px;">Ø§Ù„Ù…Ø¹Ø¯Ù„</td>
                    <td>{{ avg_sem1 }}</td>
                    <td colspan="2" style="text-align: left; padding-left: 5px;">Ø§Ù„Ù…Ø¹Ø¯Ù„</td>
                    <td>{{ avg_sem2 }}</td>
                </tr>
            </tbody>
        </table>

        <div class="footer-points rtl">
            <div>1- Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª Ù„Ù„ÙØµÙ„ÙŠÙ†: <b>{{ course_credits_sum }}</b></div>
            <div>2- Ø¹Ø¯Ø¯ ÙˆØ­Ø¯Ø§Øª Ø§Ù„Ø±Ø³Ø§Ù„Ø©: <b>{{ thesis_credits }}</b></div>
            <div>3- Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„ÙˆØ­Ø¯Ø§Øª: <b>{{ total_credits_all }}</b></div>
            <div>4- Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©: <b>{{ thesis_grade }}</b></div>
            <div>5- Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ (Ø´Ø§Ù…Ù„Ø§Ù‹ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ù„ÙØµÙ„ÙŠÙ†): <b>{{ admission.avg if admission.avg else '.......' }}</b></div>
            <div>6- Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©: ( <b>{{ research.title if research and research.title else '..................................................' }}</b> ).</div>
        </div>
    </div>


    <div class="sheet rtl">
        <div class="signatures-container rtl" style="direction: rtl;">
            <div class="signatures-top">
                <div class="sig-box">
                    <div class="sig-title">Ù…Ù†Ø¸Ù… Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©</div>
                    <div class="sig-name">..............................</div>
                </div>
                <div class="sig-box">
                    <div class="sig-title">Ù…Ø¯Ù‚Ù‚ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©</div>
                    <div class="sig-name">..............................</div>
                </div>
            </div>

            <div class="signatures-middle">
                <div class="sig-box" style="width: 40%;">
                    <div class="sig-title">Ù…Ø¯ÙŠØ± Ø´Ø¤ÙˆÙ† Ø§Ù„Ø·Ù„Ø¨Ø© ÙˆØ§Ù„ØªØµØ¯ÙŠÙ‚Ø§Øª</div>
                    <div class="sig-name">..............................</div>
                </div>
                <div class="sig-box" style="width: 40%;">
                    <div class="sig-title">Ù…Ø³Ø§Ø¹Ø¯ Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© Ù„Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„Ø¹Ù„Ù…ÙŠØ©</div>
                    <div class="sig-name">..............................</div>
                </div>
            </div>

            <div class="signatures-bottom">
                <div class="sig-box" style="margin: 0 auto; width: 50%;">
                    <div class="sig-title">Ø±Ø¦ÙŠØ³ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© ÙˆÙƒØ§Ù„Ø©</div>
                    <div class="sig-name">..............................</div>
                </div>
            </div>

            <div style="display: flex; justify-content: space-between; margin-top: 60px; font-weight: bold; font-size: 11pt;">
                <div>Ø§Ù„Ù…Ø³Ø¬Ù„</div>
                <div>Ù…Ø¹Ø§ÙˆÙ† Ø§Ù„Ø¹Ù…ÙŠØ¯</div>
                <div>Ø§Ù„Ø¹Ù…ÙŠØ¯</div>
            </div>
        </div>
    </div>

</body>
</html>